<!DOCTYPE html>
<html>
<head>
    <title>Teste PIX Direto</title>
    <style>
        body { padding: 20px; font-family: Arial; }
        .container { max-width: 600px; margin: 0 auto; }
        button { padding: 12px 24px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #45a049; }
        .result { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste Validador PIX</h1>
        
        <p>Este teste verifica se o validador PIX est√° funcionando:</p>
        
        <button onclick="testarPIX()">Testar Sistema PIX</button>
        
        <div id="resultado" class="result"></div>
        
        <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <h3>üìã 5 Situa√ß√µes de Valida√ß√£o:</h3>
            <ol>
                <li><strong>Transa√ß√£o duplicada:</strong> RECUSADO</li>
                <li><strong>Nome diferente:</strong> RECUSADO</li>
                <li><strong>Valor &lt; R$ 10,00:</strong> RECUSADO</li>
                <li><strong>Data diferente:</strong> RECUSADO</li>
                <li><strong>Tudo correto:</strong> APROVADO</li>
            </ol>
        </div>
    </div>

    <script type="module">
        async function testarPIX() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Testando...';
            
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.innerHTML = '<p>Carregando m√≥dulo PIX...</p>';
            
            try {
                // Importar o m√≥dulo PIX
                const module = await import('./src/services/enhancedPixValidator.js');
                const validator = module.pixValidator;
                
                // Testar situa√ß√£o 5 (APROVADO)
                const hoje = new Date().toISOString().split('T')[0];
                const idUnico = 'TEST_' + Date.now();
                
                resultadoDiv.innerHTML = '<p>Validando comprovante...</p>';
                
                const result = await validator.validateReceipt({
                    beneficiary: 'GUSTAVO SANTOS RIBEIRO',
                    amount: '15.00',
                    date: hoje,
                    transactionId: idUnico
                });
                
                resultadoDiv.className = 'result ' + (result.status === 'APROVADO' ? 'success' : 'error');
                resultadoDiv.innerHTML = `
                    <h3>${result.status === 'APROVADO' ? '‚úÖ APROVADO' : '‚ùå RECUSADO'}</h3>
                    <p><strong>Mensagem:</strong> ${result.message}</p>
                    <p><strong>Detalhes:</strong> ${result.details}</p>
                    <p><small>ID da transa√ß√£o: ${idUnico}</small></p>
                `;
                
                console.log('Resultado do teste:', result);
                
            } catch (error) {
                resultadoDiv.className = 'result error';
                resultadoDiv.innerHTML = `
                    <h3>‚ùå ERRO</h3>
                    <p><strong>Erro:</strong> ${error.message}</p>
                    <p><strong>Stack:</strong> ${error.stack}</p>
                `;
                console.error('Erro no teste:', error);
            }
            
            btn.disabled = false;
            btn.textContent = 'Testar Sistema PIX';
        }
        
        window.testarPIX = testarPIX;
    </script>
</body>
</html>
