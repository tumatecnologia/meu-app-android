var Q={exports:{}},ye;function We(){return ye||(ye=1,(function(u){var t=(function(e){var n=Object.prototype,a=n.hasOwnProperty,s=Object.defineProperty||function(o,r,i){o[r]=i.value},c,p=typeof Symbol=="function"?Symbol:{},I=p.iterator||"@@iterator",D=p.asyncIterator||"@@asyncIterator",N=p.toStringTag||"@@toStringTag";function A(o,r,i){return Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),o[r]}try{A({},"")}catch{A=function(r,i,d){return r[i]=d}}function $(o,r,i,d){var l=r&&r.prototype instanceof R?r:R,m=Object.create(l.prototype),S=new x(d||[]);return s(m,"_invoke",{value:Z(o,i,S)}),m}e.wrap=$;function y(o,r,i){try{return{type:"normal",arg:o.call(r,i)}}catch(d){return{type:"throw",arg:d}}}var q="suspendedStart",g="suspendedYield",v="executing",P="completed",E={};function R(){}function T(){}function _(){}var B={};A(B,I,function(){return this});var J=Object.getPrototypeOf,G=J&&J(J(z([])));G&&G!==n&&a.call(G,I)&&(B=G);var V=_.prototype=R.prototype=Object.create(B);T.prototype=_,s(V,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:T,configurable:!0}),T.displayName=A(_,N,"GeneratorFunction");function H(o){["next","throw","return"].forEach(function(r){A(o,r,function(i){return this._invoke(r,i)})})}e.isGeneratorFunction=function(o){var r=typeof o=="function"&&o.constructor;return r?r===T||(r.displayName||r.name)==="GeneratorFunction":!1},e.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,_):(o.__proto__=_,A(o,N,"GeneratorFunction")),o.prototype=Object.create(V),o},e.awrap=function(o){return{__await:o}};function j(o,r){function i(m,S,w,b){var L=y(o[m],o,S);if(L.type==="throw")b(L.arg);else{var f=L.arg,h=f.value;return h&&typeof h=="object"&&a.call(h,"__await")?r.resolve(h.__await).then(function(O){i("next",O,w,b)},function(O){i("throw",O,w,b)}):r.resolve(h).then(function(O){f.value=O,w(f)},function(O){return i("throw",O,w,b)})}}var d;function l(m,S){function w(){return new r(function(b,L){i(m,S,b,L)})}return d=d?d.then(w,w):w()}s(this,"_invoke",{value:l})}H(j.prototype),A(j.prototype,D,function(){return this}),e.AsyncIterator=j,e.async=function(o,r,i,d,l){l===void 0&&(l=Promise);var m=new j($(o,r,i,d),l);return e.isGeneratorFunction(r)?m:m.next().then(function(S){return S.done?S.value:m.next()})};function Z(o,r,i){var d=q;return function(m,S){if(d===v)throw new Error("Generator is already running");if(d===P){if(m==="throw")throw S;return K()}for(i.method=m,i.arg=S;;){var w=i.delegate;if(w){var b=F(w,i);if(b){if(b===E)continue;return b}}if(i.method==="next")i.sent=i._sent=i.arg;else if(i.method==="throw"){if(d===q)throw d=P,i.arg;i.dispatchException(i.arg)}else i.method==="return"&&i.abrupt("return",i.arg);d=v;var L=y(o,r,i);if(L.type==="normal"){if(d=i.done?P:g,L.arg===E)continue;return{value:L.arg,done:i.done}}else L.type==="throw"&&(d=P,i.method="throw",i.arg=L.arg)}}}function F(o,r){var i=r.method,d=o.iterator[i];if(d===c)return r.delegate=null,i==="throw"&&o.iterator.return&&(r.method="return",r.arg=c,F(o,r),r.method==="throw")||i!=="return"&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),E;var l=y(d,o.iterator,r.arg);if(l.type==="throw")return r.method="throw",r.arg=l.arg,r.delegate=null,E;var m=l.arg;if(!m)return r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,E;if(m.done)r[o.resultName]=m.value,r.next=o.nextLoc,r.method!=="return"&&(r.method="next",r.arg=c);else return m;return r.delegate=null,E}H(V),A(V,N,"Generator"),A(V,I,function(){return this}),A(V,"toString",function(){return"[object Generator]"});function M(o){var r={tryLoc:o[0]};1 in o&&(r.catchLoc=o[1]),2 in o&&(r.finallyLoc=o[2],r.afterLoc=o[3]),this.tryEntries.push(r)}function W(o){var r=o.completion||{};r.type="normal",delete r.arg,o.completion=r}function x(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(M,this),this.reset(!0)}e.keys=function(o){var r=Object(o),i=[];for(var d in r)i.push(d);return i.reverse(),function l(){for(;i.length;){var m=i.pop();if(m in r)return l.value=m,l.done=!1,l}return l.done=!0,l}};function z(o){if(o){var r=o[I];if(r)return r.call(o);if(typeof o.next=="function")return o;if(!isNaN(o.length)){var i=-1,d=function l(){for(;++i<o.length;)if(a.call(o,i))return l.value=o[i],l.done=!1,l;return l.value=c,l.done=!0,l};return d.next=d}}return{next:K}}e.values=z;function K(){return{value:c,done:!0}}return x.prototype={constructor:x,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(W),!o)for(var r in this)r.charAt(0)==="t"&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=c)},stop:function(){this.done=!0;var o=this.tryEntries[0],r=o.completion;if(r.type==="throw")throw r.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var r=this;function i(b,L){return m.type="throw",m.arg=o,r.next=b,L&&(r.method="next",r.arg=c),!!L}for(var d=this.tryEntries.length-1;d>=0;--d){var l=this.tryEntries[d],m=l.completion;if(l.tryLoc==="root")return i("end");if(l.tryLoc<=this.prev){var S=a.call(l,"catchLoc"),w=a.call(l,"finallyLoc");if(S&&w){if(this.prev<l.catchLoc)return i(l.catchLoc,!0);if(this.prev<l.finallyLoc)return i(l.finallyLoc)}else if(S){if(this.prev<l.catchLoc)return i(l.catchLoc,!0)}else if(w){if(this.prev<l.finallyLoc)return i(l.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(o,r){for(var i=this.tryEntries.length-1;i>=0;--i){var d=this.tryEntries[i];if(d.tryLoc<=this.prev&&a.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var l=d;break}}l&&(o==="break"||o==="continue")&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var m=l?l.completion:{};return m.type=o,m.arg=r,l?(this.method="next",this.next=l.finallyLoc,E):this.complete(m)},complete:function(o,r){if(o.type==="throw")throw o.arg;return o.type==="break"||o.type==="continue"?this.next=o.arg:o.type==="return"?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):o.type==="normal"&&r&&(this.next=r),E},finish:function(o){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===o)return this.complete(i.completion,i.afterLoc),W(i),E}},catch:function(o){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===o){var d=i.completion;if(d.type==="throw"){var l=d.arg;W(i)}return l}}throw new Error("illegal catch attempt")},delegateYield:function(o,r,i){return this.delegate={iterator:z(o),resultName:r,nextLoc:i},this.method==="next"&&(this.arg=c),E}},e})(u.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(Q)),Q.exports}var ee,Ee;function Ae(){return Ee||(Ee=1,ee=(u,t)=>`${u}-${t}-${Math.random().toString(16).slice(3,8)}`),ee}var te,Se;function Be(){if(Se)return te;Se=1;const u=Ae();let t=0;return te=({id:e,action:n,payload:a={}})=>{let s=e;return typeof s>"u"&&(s=u("Job",t),t+=1),{id:s,action:n,payload:a}},te}var Y={},we;function Re(){if(we)return Y;we=1;let u=!1;return Y.logging=u,Y.setLogging=t=>{u=t},Y.log=(...t)=>u?console.log.apply(this,t):null,Y}var re,Le;function xe(){if(Le)return re;Le=1;const u=Be(),{log:t}=Re(),e=Ae();let n=0;return re=()=>{const a=e("Scheduler",n),s={},c={};let p=[];n+=1;const I=()=>p.length,D=()=>Object.keys(s).length,N=()=>{if(p.length!==0){const g=Object.keys(s);for(let v=0;v<g.length;v+=1)if(typeof c[g[v]]>"u"){p[0](s[g[v]]);break}}},A=(g,v)=>new Promise((P,E)=>{const R=u({action:g,payload:v});p.push(async T=>{p.shift(),c[T.id]=R;try{P(await T[g].apply(this,[...v,R.id]))}catch(_){E(_)}finally{delete c[T.id],N()}}),t(`[${a}]: Add ${R.id} to JobQueue`),t(`[${a}]: JobQueue length=${p.length}`),N()});return{addWorker:g=>(s[g.id]=g,t(`[${a}]: Add ${g.id}`),t(`[${a}]: Number of workers=${D()}`),N(),g.id),addJob:async(g,...v)=>{if(D()===0)throw Error(`[${a}]: You need to have at least one worker before adding jobs`);return A(g,v)},terminate:async()=>{Object.keys(s).forEach(async g=>{await s[g].terminate()}),p=[]},getQueueLen:I,getNumWorkers:D}},re}function ze(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oe,Ie;function Ye(){return Ie||(Ie=1,oe=u=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof ze=="function"&&(t.type="node"),typeof u>"u"?t:t[u]}),oe}var ne,Te;function Ke(){if(Te)return ne;Te=1;const t=Ye()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return ne=e=>{const n={...e};return["corePath","workerPath","langPath"].forEach(a=>{e[a]&&(n[a]=t(n[a]))}),n},ne}var ae,be;function Je(){return be||(be=1,ae={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),ae}const Ze="6.0.1",Xe={version:Ze};var ie,Ne;function Qe(){return Ne||(Ne=1,ie={workerBlobURL:!0,logger:()=>{}}),ie}var se,De;function et(){if(De)return se;De=1;const u=Xe.version;return se={...Qe(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${u}/dist/worker.min.js`},se}var ce,_e;function tt(){return _e||(_e=1,ce=({workerPath:u,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const n=new Blob([`importScripts("${u}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(n))}else e=new Worker(u);return e}),ce}var le,Me;function rt(){return Me||(Me=1,le=u=>{u.terminate()}),le}var ue,ke;function ot(){return ke||(ke=1,ue=(u,t)=>{u.onmessage=({data:e})=>{t(e)}}),ue}var de,Ce;function nt(){return Ce||(Ce=1,de=async(u,t)=>{u.postMessage(t)}),de}var fe,Pe;function at(){if(Pe)return fe;Pe=1;const u=e=>new Promise((n,a)=>{const s=new FileReader;s.onload=()=>{n(s.result)},s.onerror=({target:{error:{code:c}}})=>{a(Error(`File could not be read! Code=${c}`))},s.readAsArrayBuffer(e)}),t=async e=>{let n=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?n=atob(e.split(",")[1]).split("").map(a=>a.charCodeAt(0)):n=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(n=await t(e.src)),e.tagName==="VIDEO"&&(n=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(a=>{e.toBlob(async s=>{n=await u(s),a()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const a=await e.convertToBlob();n=await u(a)}else(e instanceof File||e instanceof Blob)&&(n=await u(e));return new Uint8Array(n)};return fe=t,fe}var he,$e;function it(){if($e)return he;$e=1;const u=et(),t=tt(),e=rt(),n=ot(),a=nt(),s=at();return he={defaultOptions:u,spawnWorker:t,terminateWorker:e,onMessage:n,send:a,loadImage:s},he}var me,Ve;function je(){if(Ve)return me;Ve=1;const u=Ke(),t=Be(),{log:e}=Re(),n=Ae(),a=Je(),{defaultOptions:s,spawnWorker:c,terminateWorker:p,onMessage:I,loadImage:D,send:N}=it();let A=0;return me=async($="eng",y=a.LSTM_ONLY,q={},g={})=>{const v=n("Worker",A),{logger:P,errorHandler:E,...R}=u({...s,...q}),T={},_=typeof $=="string"?$.split("+"):$;let B=y,J=g;const G=[a.DEFAULT,a.LSTM_ONLY].includes(y)&&!R.legacyCore;let V,H;const j=new Promise((f,h)=>{H=f,V=h}),Z=f=>{V(f.message)};let F=c(R);F.onerror=Z,A+=1;const M=({id:f,action:h,payload:O})=>new Promise((k,C)=>{e(`[${v}]: Start ${f}, action=${h}`);const U=`${h}-${f}`;T[U]={resolve:k,reject:C},N(F,{workerId:v,jobId:f,action:h,payload:O})}),W=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),x=f=>M(t({id:f,action:"load",payload:{options:{lstmOnly:G,corePath:R.corePath,logging:R.logging}}})),z=(f,h,O)=>M(t({id:O,action:"FS",payload:{method:"writeFile",args:[f,h]}})),K=(f,h)=>M(t({id:h,action:"FS",payload:{method:"readFile",args:[f,{encoding:"utf8"}]}})),o=(f,h)=>M(t({id:h,action:"FS",payload:{method:"unlink",args:[f]}})),r=(f,h,O)=>M(t({id:O,action:"FS",payload:{method:f,args:h}})),i=(f,h)=>M(t({id:h,action:"loadLanguage",payload:{langs:f,options:{langPath:R.langPath,dataPath:R.dataPath,cachePath:R.cachePath,cacheMethod:R.cacheMethod,gzip:R.gzip,lstmOnly:[a.DEFAULT,a.LSTM_ONLY].includes(B)&&!R.legacyLang}}})),d=(f,h,O,k)=>M(t({id:k,action:"initialize",payload:{langs:f,oem:h,config:O}})),l=(f="eng",h,O,k)=>{if(G&&[a.TESSERACT_ONLY,a.TESSERACT_LSTM_COMBINED].includes(h))throw Error("Legacy model requested but code missing.");const C=h||B;B=C;const U=O||J;J=U;const X=(typeof f=="string"?f.split("+"):f).filter(He=>!_.includes(He));return _.push(...X),X.length>0?i(X,k).then(()=>d(f,C,U,k)):d(f,C,U,k)},m=(f={},h)=>M(t({id:h,action:"setParameters",payload:{params:f}})),S=async(f,h={},O={text:!0},k)=>M(t({id:k,action:"recognize",payload:{image:await D(f),options:h,output:O}})),w=async(f,h)=>{if(G)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return M(t({id:h,action:"detect",payload:{image:await D(f)}}))},b=async()=>(F!==null&&(p(F),F=null),Promise.resolve());I(F,({workerId:f,jobId:h,status:O,action:k,data:C})=>{const U=`${k}-${h}`;if(O==="resolve")e(`[${f}]: Complete ${h}`),T[U].resolve({jobId:h,data:C}),delete T[U];else if(O==="reject")if(T[U].reject(C),delete T[U],k==="load"&&V(C),E)E(C);else throw Error(C);else O==="progress"&&P({...C,userJobId:h})});const L={id:v,worker:F,load:W,writeText:z,readText:K,removeFile:o,FS:r,reinitialize:l,setParameters:m,recognize:S,detect:w,terminate:b};return x().then(()=>i($)).then(()=>d($,y,g)).then(()=>H(L)).catch(()=>{}),j},me}var ge,Fe;function st(){if(Fe)return ge;Fe=1;const u=je();return ge={recognize:async(n,a,s)=>{const c=await u(a,1,s);return c.recognize(n).finally(async()=>{await c.terminate()})},detect:async(n,a)=>{const s=await u("osd",0,a);return s.detect(n).finally(async()=>{await s.terminate()})}},ge}var pe,Ue;function ct(){return Ue||(Ue=1,pe={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),pe}var Oe,qe;function lt(){return qe||(qe=1,Oe={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Oe}var ve,Ge;function ut(){if(Ge)return ve;Ge=1,We();const u=xe(),t=je(),e=st(),n=ct(),a=Je(),s=lt(),{setLogging:c}=Re();return ve={languages:n,OEM:a,PSM:s,createScheduler:u,createWorker:t,setLogging:c,...e},ve}var dt=ut();class ft{static async getWorker(){const t=await dt.createWorker();return await t.loadLanguage("por"),await t.initialize("por"),await t.setParameters({tessedit_pageseg_mode:"6",tessedit_ocr_engine_mode:"1",preserve_interword_spaces:"1",tessedit_char_whitelist:`0123456789R$:.,/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZÃ€ÃÃ‚ÃƒÃ‡Ã‰ÃŠÃÃ“Ã”Ã•ÃšÃœÃ Ã¡Ã¢Ã£Ã§Ã©ÃªÃ­Ã³Ã´ÃµÃºÃ¼ 
-`,user_defined_dpi:"300"}),t}static async extractTextFromImage(t){console.log("ðŸ” [OCR] Processando imagem:",t.name),console.log("ðŸ“± Detalhes:",t.type,Math.round(t.size/1024)+"KB");try{const e=await this.getWorker(),{data:{text:n}}=await e.recognize(t);await e.terminate();const a=n.replace(/\s+/g," ").replace(/[|]/g,"I").replace(/[0]/g,"O").trim();return console.log("âœ… [OCR] Texto extraÃ­do com sucesso"),console.log("ðŸ“„ Amostra (300 chars):",a.substring(0,300)+"..."),a.toUpperCase()}catch(e){throw console.error("âŒ [OCR] Erro:",e.message),e}}static extractDate(t){console.log("ðŸ“… [DATA] Extraindo data...");const e=[/(\d{1,2})\/(\d{1,2})\/(\d{4})/,/(\d{1,2})\/(\d{1,2})/,/(\d{1,2})\s+(JAN|FEV|MAR|ABR|MAI|JUN|JUL|AGO|SET|OUT|NOV|DEZ)/i,/(\d{1,2})\s+(JANEIRO|FEVEREIRO|MARÃ‡O|ABRIL|MAIO|JUNHO|JULHO|AGOSTO|SETEMBRO|OUTUBRO|NOVEMBRO|DEZEMBRO)/i,/DATA.*?(\d{1,2})\/(\d{1,2})\/(\d{4})/i,/(\d{1,2})\.(\d{1,2})\.(\d{4})/];for(const n of e){const a=t.match(n);if(a){let s,c;a[2]&&a[2].match(/^[A-Z]/i)?(s=a[1].padStart(2,"0"),c={JAN:"01",FEV:"02",MAR:"03",ABR:"04",MAI:"05",JUN:"06",JUL:"07",AGO:"08",SET:"09",OUT:"10",NOV:"11",DEZ:"12"}[a[2].toUpperCase().substring(0,3)]||"12"):(s=a[1].padStart(2,"0"),c=a[2]?a[2].padStart(2,"0"):"12");const p=`${s}/${c}`;return console.log(`âœ… [DATA] Encontrada: ${p}`),p}}return console.log("âš ï¸ [DATA] Nenhuma data encontrada"),null}static extractTime(t){console.log("â° [HORA] Extraindo hora...");const e=[/(\d{1,2}):(\d{2})/,/(\d{1,2})H(\d{2})/i,/(\d{1,2})H\s*(\d{2})/i,/HORA.*?(\d{1,2}):(\d{2})/i,/HOR.*RIO.*?(\d{1,2}):(\d{2})/i,/(\d{1,2}):(\d{2}):(\d{2})/];for(const n of e){const a=t.match(n);if(a){const s=a[1].padStart(2,"0"),c=a[2].padStart(2,"0"),p=`${s}:${c}`;return console.log(`âœ… [HORA] Encontrada: ${p}`),p}}return console.log("âš ï¸ [HORA] Nenhuma hora encontrada"),null}static extractAmount(t){console.log("ðŸ’° [VALOR] Extraindo valor...");const e=[/R\$\s*(\d+)[,\.](\d{2})/i,/R\$\s*(\d+)/i,/VALOR[\s:]*R\$\s*(\d+)[,\.](\d{2})/i,/VALOR[\s:]*(\d+)[,\.](\d{2})/i,/PAG(O|AMENTO)[\s:]*R\$\s*(\d+)[,\.](\d{2})/i,/TRANSFER[ÃŠA]*[\s:]*R\$\s*(\d+)[,\.](\d{2})/i,/(\d+)[,\.]00\b/,/DEZ\s+REAIS/i];for(const n of e){const a=t.match(n);if(a){let s,c;n.toString().includes("DEZ")?(s="10",c="00"):(s=a[1]||a[2]||"10",c=a[2]||"00");const p=parseFloat(`${s}.${c}`);return console.log(`âœ… [VALOR] Encontrado: R$ ${p.toFixed(2)}`),p}}return console.log("âš ï¸ [VALOR] Nenhum valor encontrado"),null}static extractBeneficiary(t){console.log("ðŸ‘¤ [NOME] Extraindo beneficiÃ¡rio...");const e=[/GUSTAVO[\s\w]{0,15}SANTOS[\s\w]{0,15}RIBEIRO/i,/GUSTAVO[\s\w]{0,15}RIBEIRO/i,/GUSTAVO[\s\w]{0,5}S[\s\w]{0,5}RIBEIRO/i,/GUSTAVO[\s\w]{0,5}S\.?[\s\w]{0,5}RIBEIRO/i,/PARA[\s:]*GUSTAVO[\s\w]+RIBEIRO/i,/FAVORECIDO[\s:]*GUSTAVO[\s\w]+RIBEIRO/i,/BENEFICI[ÃA]RIO[\s:]*GUSTAVO[\s\w]+RIBEIRO/i,/(?:PARA|FAVORECIDO|BENEFICI[ÃA]RIO)[\s:]*([A-Z\s]{10,50})/i];for(const a of e){const s=t.match(a);if(s){let c=s[0];if(c=c.replace(/^(PARA|FAVORECIDO|BENEFICI[ÃA]RIO)[\s:]*/i,""),c=c.trim(),c.includes("GUSTAVO")&&c.includes("RIBEIRO"))return console.log(`âœ… [NOME] Encontrado: ${c}`),c}}const n=t.match(/(GUSTAVO[\s\w]{5,30})/i);return n?(console.log(`âš ï¸ [NOME] PossÃ­vel nome encontrado: ${n[0]}`),n[0]):(console.log("âš ï¸ [NOME] Nenhum nome encontrado"),null)}static async processImage(t){console.log("=".repeat(50)),console.log("ðŸ”® PROCESSANDO COMPROVANTE PIX"),console.log("=".repeat(50));try{const e=await this.extractTextFromImage(t),n={date:this.extractDate(e),time:this.extractTime(e),amount:this.extractAmount(e),beneficiary:this.extractBeneficiary(e)};if(console.log("ðŸ“Š RESUMO DOS DADOS EXTRAÃDOS:"),console.log("- Data:",n.date||"NÃ£o encontrada"),console.log("- Hora:",n.time||"NÃ£o encontrada"),console.log("- Valor:",n.amount?`R$ ${n.amount.toFixed(2)}`:"NÃ£o encontrado"),console.log("- Nome:",n.beneficiary||"NÃ£o encontrado"),n.date&&n.time&&n.amount&&n.beneficiary)return console.log("ðŸŽ‰ âœ… TODOS OS DADOS FORAM EXTRAÃDOS COM SUCESSO!"),{success:!0,message:"âœ… OCR realizado com sucesso!",data:n};{const s=[];return n.date||s.push("data"),n.time||s.push("hora"),n.amount||s.push("valor"),n.beneficiary||s.push("nome"),console.log(`âš ï¸ DADOS FALTANDO: ${s.join(", ")}`),{success:!1,message:`Dados incompletos: ${s.join(", ")}`,data:n,missing:s}}}catch(e){return console.error("âŒ ERRO NO PROCESSAMENTO:",e),{success:!1,message:`Erro: ${e.message}`,data:null,error:e.message}}}}class mt{static validateDateTime(t,e){console.log("ðŸ“…â° [VALIDAÃ‡ÃƒO] Validando data e hora do comprovante..."),console.log(`   Data do comprovante: "${t}"`),console.log(`   Hora do comprovante: "${e}"`);try{if(!t||!e)return console.log("âŒ Data ou hora nÃ£o fornecida"),!1;const n=new Date;console.log(`   Hora atual do sistema: ${n.toLocaleString("pt-BR")}`);let a,s,c;if(t.includes("/")){const g=t.split("/");a=parseInt(g[0]),s=parseInt(g[1])-1,g.length>=3?(c=parseInt(g[2]),c<100&&(c+=2e3)):c=n.getFullYear()}else{const g=t.split(" ");if(g.length>=2){a=parseInt(g[0]);const v=g[1].toLowerCase().substring(0,3),P={jan:0,fev:1,mar:2,abr:3,mai:4,jun:5,jul:6,ago:7,set:8,out:9,nov:10,dez:11};s=P[v]!==void 0?P[v]:11,c=n.getFullYear()}else return console.log("âŒ Formato de data invÃ¡lido"),!1}let p,I;const N=e.replace("h",":").replace("H",":").split(":");if(N.length>=2)p=parseInt(N[0]),I=parseInt(N[1]);else return console.log("âŒ Formato de hora invÃ¡lido"),!1;const A=new Date(c,s,a,p,I,0,0);console.log(`   Data/hora do comprovante: ${A.toLocaleString("pt-BR")}`);const y=(n.getTime()-A.getTime())/(1e3*60);console.log(`   DiferenÃ§a: ${y.toFixed(1)} minutos`);const q=y>=0&&y<=10;return q?console.log(`âœ… DATA/HORA VÃLIDA! Comprovante emitido hÃ¡ ${y.toFixed(1)} minutos`):y<0?console.log(`âŒ DATA/HORA INVÃLIDA! Comprovante Ã© do FUTURO (${Math.abs(y).toFixed(1)} minutos adiantado)`):console.log(`âŒ DATA/HORA INVÃLIDA! Comprovante tem ${y.toFixed(1)} minutos (mÃ¡ximo: 10 minutos)`),q}catch(n){return console.error("âŒ Erro na validaÃ§Ã£o de data/hora:",n),!1}}static isValidBeneficiary(t){if(!t)return!1;const e=t.replace(/\n/g," ").trim().toLowerCase(),n=e.includes("gustavo")&&e.includes("ribeiro")&&(e.includes("santos")||e.includes(" s ")||e.includes(" s. "));return console.log(`ðŸ‘¤ [NOME] Validando: "${t}" -> "${e}" (${n?"âœ…":"âŒ"})`),n}static isValidAmount(t){if(console.log("ðŸ’° [VALOR] Validando valor..."),t==null)return console.log("âŒ VALOR NULO OU INDEFINIDO"),!1;const e=10,n=.009;console.log(`ðŸ’° Valor mÃ­nimo aceito: R$ ${e.toFixed(2)}`),console.log(`ðŸ’° Valor recebido: R$ ${t.toFixed(2)}`);const a=t>=e-n;return a?console.log(`âœ… VALOR ACEITO! R$ ${t.toFixed(2)} (â‰¥ R$ ${e.toFixed(2)})`):(console.log("âŒâŒâŒ VALOR REJEITADO! âŒâŒâŒ"),console.log(`ðŸš¨ MOTIVO: O valor deve ser IGUAL OU MAIOR que R$ ${e.toFixed(2)}`),console.log(`ðŸš¨ Valor mÃ­nimo: R$ ${e.toFixed(2)}`),console.log(`ðŸš¨ Valor recebido: R$ ${t.toFixed(2)}`),console.log("ðŸš¨ O PAGAMENTO SERÃ REJEITADO!")),a}static async processarArquivo(t){console.log("=".repeat(50)),console.log("ðŸ”® PROCESSANDO COMPROVANTE PIX"),console.log("=".repeat(50));try{const e=await ft.processImage(t);if(!e.success){console.log("âš ï¸ OCR encontrou problemas:",e.message);const s=e.data||{},c={datetime:this.validateDateTime(s.date,s.time),beneficiary:this.isValidBeneficiary(s.beneficiary),amount:this.isValidAmount(s.amount)};if(console.log("ðŸ“Š ValidaÃ§Ãµes:",c),c.datetime&&c.beneficiary&&c.amount){const I={id:Date.now().toString(),date:s.date,time:s.time,beneficiary:s.beneficiary,amount:s.amount,fileName:t.name,timestamp:new Date().toISOString(),status:"validated"},D=JSON.parse(localStorage.getItem("tarot_payments_db")||"[]");return D.push(I),localStorage.setItem("tarot_payments_db",JSON.stringify(D)),console.log("âœ…âœ…âœ… PAGAMENTO VALIDADO! âœ…âœ…âœ…"),{valido:!0,mensagem:"âœ… Pagamento validado com sucesso!",paymentId:I.id}}return{valido:!1,mensagem:"âŒ Dados incompletos no comprovante",necessidadeFormulario:!0,dadosExtraidos:s}}const n=e.data,a={datetime:this.validateDateTime(n.date,n.time),nome:this.isValidBeneficiary(n.beneficiary),valor:this.isValidAmount(n.amount)};if(console.log("ðŸ“Š ValidaÃ§Ãµes completas:",a),a.datetime&&a.nome&&a.valor){const s={id:Date.now().toString(),date:n.date,time:n.time,beneficiary:n.beneficiary,amount:n.amount,fileName:t.name,timestamp:new Date().toISOString(),status:"validated",readingAccessed:!1},c=JSON.parse(localStorage.getItem("tarot_payments_db")||"[]");return c.push(s),localStorage.setItem("tarot_payments_db",JSON.stringify(c)),console.log("âœ…âœ…âœ… PAGAMENTO VALIDADO VIA OCR! âœ…âœ…âœ…"),{valido:!0,mensagem:"âœ… Pagamento validado! Liberando consulta...",paymentId:s.id}}return{valido:!1,mensagem:"âŒ Dados invÃ¡lidos no comprovante",necessidadeFormulario:!0,dadosExtraidos:n}}catch(e){return console.error("âŒ ERRO NO PROCESSAMENTO:",e),{valido:!1,mensagem:`âŒ Erro: ${e.message}`,necessidadeFormulario:!0}}}static checkReadingAccess(){try{return JSON.parse(localStorage.getItem("tarot_payments_db")||"[]").find(e=>e.status==="validated"&&!e.readingAccessed)}catch{return null}}static markReadingAsAccessed(t){try{const n=JSON.parse(localStorage.getItem("tarot_payments_db")||"[]").map(a=>a.id===t?{...a,readingAccessed:!0}:a);return localStorage.setItem("tarot_payments_db",JSON.stringify(n)),!0}catch{return!1}}}export{mt as default};
